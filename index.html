<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>NAGAR PALIKA NAKUR - गजब प्रशासन पोर्टल</title>
  <link rel="icon" href="https://sunnydhaka.fwh.is/img1.png" type="image/png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Noto+Sans+Devanagari:wght@400;600;700&display=swap" rel="stylesheet">
  
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

  <style>
    :root {
      --gold: #FFD700;
      --gold-dark: #FFA500;
      --gold-light: #FFF8DC;
      --navy: #0A1931;
      --navy-light: #1A2B4D;
      --white: #FFFFFF;
      --success: #27ae60;
      --error: #e74c3c;
      --shadow: 0 15px 35px rgba(0, 0, 0, 0.6);
      --radius: 20px;
      --transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', 'Noto Sans Devanagari', sans-serif;
      background: linear-gradient(135deg, #0A1931 0%, #1A2B4D 50%, #0F2557 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: var(--white);
      overflow-x: hidden;
      padding: 20px;
      position: relative;
    }

    /* बैकग्राउंड डिजाइन */
    .bg-pattern {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(255, 165, 0, 0.1) 0%, transparent 50%);
      z-index: 0;
    }

    .particle {
      position: fixed;
      width: 4px;
      height: 4px;
      background: var(--gold);
      border-radius: 50%;
      animation: float 15s infinite linear;
      pointer-events: none;
    }

    @keyframes float {
      0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
    }

    /* मुख्य कंटेनर */
    .main-container {
      width: 100%;
      max-width: 1200px;
      position: relative;
      z-index: 2;
    }

    /* हेडर - गजब स्टाइल */
    .gajab-header {
      text-align: center;
      margin-bottom: 40px;
      position: relative;
    }

    .gajab-header h1 {
      font-size: 3.5rem;
      font-weight: 800;
      color: var(--gold);
      text-transform: uppercase;
      letter-spacing: 3px;
      margin-bottom: 10px;
      text-shadow: 
        0 0 10px rgba(255, 215, 0, 0.5),
        0 0 20px rgba(255, 215, 0, 0.3),
        0 0 30px rgba(255, 215, 0, 0.2);
      animation: glow 2s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { text-shadow: 0 0 10px rgba(255, 215, 0, 0.5), 0 0 20px rgba(255, 215, 0, 0.3), 0 0 30px rgba(255, 215, 0, 0.2); }
      to { text-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 0 30px rgba(255, 215, 0, 0.5), 0 0 40px rgba(255, 215, 0, 0.3), 0 0 50px rgba(255, 215, 0, 0.2); }
    }

    .gajab-header h2 {
      font-size: 1.8rem;
      color: var(--white);
      font-weight: 300;
      letter-spacing: 2px;
      margin-bottom: 15px;
    }

    .gajab-tagline {
      display: inline-block;
      background: linear-gradient(45deg, var(--gold), var(--gold-dark));
      padding: 10px 25px;
      border-radius: 50px;
      font-weight: 600;
      color: var(--navy);
      letter-spacing: 1px;
      box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
      transform: perspective(500px) rotateX(10deg);
      transition: var(--transition);
    }

    .gajab-tagline:hover {
      transform: perspective(500px) rotateX(0deg) scale(1.05);
      box-shadow: 0 10px 25px rgba(255, 215, 0, 0.6);
    }

    /* लॉगिन कार्ड - गजब डिजाइन */
    .gajab-card {
      background: rgba(10, 25, 49, 0.85);
      backdrop-filter: blur(20px);
      border-radius: var(--radius);
      padding: 50px;
      display: flex;
      flex-wrap: wrap;
      gap: 50px;
      box-shadow: var(--shadow);
      border: 2px solid rgba(255, 215, 0, 0.3);
      position: relative;
      overflow: hidden;
    }

    .gajab-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(90deg, var(--gold), var(--gold-dark), var(--gold));
      animation: shimmer 3s infinite linear;
    }

    @keyframes shimmer {
      0% { background-position: -200% center; }
      100% { background-position: 200% center; }
    }

    /* लोगो सेक्शन */
    .logo-section {
      flex: 1;
      min-width: 300px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .gajab-logo-container {
      position: relative;
      width: 300px;
      height: 300px;
      margin-bottom: 30px;
      perspective: 1000px;
    }

    .gajab-logo {
      width: 100%;
      height: 100%;
      object-fit: contain;
      animation: gajab-rotate 20s infinite linear;
      filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.7));
    }

    @keyframes gajab-rotate {
      0% { transform: rotateY(0deg) scale(1); }
      25% { transform: rotateY(90deg) scale(1.1); }
      50% { transform: rotateY(180deg) scale(1); }
      75% { transform: rotateY(270deg) scale(1.1); }
      100% { transform: rotateY(360deg) scale(1); }
    }

    .logo-text {
      text-align: center;
      margin-top: 20px;
    }

    .logo-text h3 {
      font-size: 2rem;
      color: var(--gold);
      margin-bottom: 10px;
      font-weight: 700;
    }

    .logo-text p {
      color: rgba(255, 255, 255, 0.8);
      line-height: 1.6;
      max-width: 350px;
    }

    /* फॉर्म सेक्शन */
    .form-section {
      flex: 1;
      min-width: 300px;
      padding: 20px;
      position: relative;
    }

    .form-header {
      text-align: center;
      margin-bottom: 40px;
    }

    .form-header h3 {
      font-size: 2.5rem;
      color: var(--gold);
      margin-bottom: 15px;
      position: relative;
      display: inline-block;
    }

    .form-header h3::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 4px;
      background: linear-gradient(90deg, transparent, var(--gold), transparent);
      border-radius: 2px;
    }

    .form-header p {
      color: rgba(255, 255, 255, 0.7);
      font-size: 1.1rem;
    }

    /* फॉर्म ग्रुप्स */
    .form-group {
      margin-bottom: 30px;
      position: relative;
    }

    .form-group label {
      display: block;
      margin-bottom: 10px;
      color: var(--gold);
      font-weight: 600;
      font-size: 1.1rem;
      letter-spacing: 1px;
    }

    .input-container {
      position: relative;
    }

    .input-container i {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gold);
      font-size: 1.2rem;
      z-index: 2;
    }

    .form-input {
      width: 100%;
      padding: 18px 20px 18px 60px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid rgba(255, 215, 0, 0.3);
      border-radius: 15px;
      color: var(--white);
      font-size: 1rem;
      transition: var(--transition);
      backdrop-filter: blur(5px);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--gold);
      background: rgba(255, 255, 255, 0.1);
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.4);
      transform: translateY(-2px);
    }

    .input-highlight {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--gold), var(--gold-dark));
      transition: width 0.4s ease;
    }

    .form-input:focus ~ .input-highlight {
      width: 100%;
    }

    /* बटन्स */
    .gajab-button {
      width: 100%;
      padding: 20px;
      background: linear-gradient(45deg, var(--gold), var(--gold-dark));
      border: none;
      border-radius: 15px;
      color: var(--navy);
      font-size: 1.3rem;
      font-weight: 700;
      letter-spacing: 2px;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      margin-top: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }

    .gajab-button:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(255, 215, 0, 0.5);
      letter-spacing: 3px;
    }

    .gajab-button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .verify-btn {
      background: linear-gradient(45deg, var(--success), #2ecc71) !important;
      color: white !important;
    }

    .button-glow {
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
      transition: left 0.7s ease;
    }

    .gajab-button:hover .button-glow {
      left: 100%;
    }

    /* रीकैप्चा कंटेनर */
    #recaptcha-container {
      margin: 20px 0;
      display: flex;
      justify-content: center;
    }

    /* नोटिफिकेशन */
    .gajab-notification {
      position: fixed;
      top: 30px;
      right: 30px;
      background: linear-gradient(45deg, var(--navy-light), var(--navy));
      padding: 20px 30px;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      border-left: 5px solid var(--gold);
      z-index: 1000;
      transform: translateX(150%);
      transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      max-width: 350px;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .gajab-notification.show {
      transform: translateX(0);
    }

    .gajab-notification.error {
      border-left-color: var(--error);
    }

    .gajab-notification.success {
      border-left-color: var(--success);
    }

    /* काउंटर */
    .timer {
      text-align: center;
      margin: 15px 0;
      font-size: 0.9rem;
      color: var(--gold);
    }

    .timer span {
      font-weight: bold;
      font-size: 1.1rem;
    }

    /* रेसेंड लिंक */
    .resend-link {
      text-align: center;
      margin-top: 15px;
    }

    .resend-link a {
      color: var(--gold);
      text-decoration: none;
      font-size: 0.9rem;
      transition: var(--transition);
    }

    .resend-link a:hover {
      text-decoration: underline;
    }

    .resend-link a:disabled {
      color: #666;
      cursor: not-allowed;
    }

    /* हिडन क्लास */
    .hidden {
      display: none !important;
    }

    /* रेस्पॉन्सिव */
    @media (max-width: 992px) {
      .gajab-card {
        flex-direction: column;
        padding: 40px;
        gap: 40px;
      }
      
      .gajab-header h1 {
        font-size: 2.8rem;
      }
      
      .gajab-logo-container {
        width: 250px;
        height: 250px;
      }
    }

    @media (max-width: 768px) {
      .gajab-card {
        padding: 30px;
      }
      
      .gajab-header h1 {
        font-size: 2.2rem;
      }
      
      .form-header h3 {
        font-size: 2rem;
      }
      
      .gajab-logo-container {
        width: 200px;
        height: 200px;
      }
    }

    @media (max-width: 480px) {
      .gajab-header h1 {
        font-size: 1.8rem;
      }
      
      .gajab-button {
        padding: 18px;
        font-size: 1.1rem;
      }
    }
  </style>
</head>
<body>
  <!-- बैकग्राउंड -->
  <div class="bg-pattern"></div>
  
  <!-- मुख्य कंटेनर -->
  <div class="main-container">
    <!-- हेडर -->
    <div class="gajab-header">
      <h1>गजब प्रशासन पोर्टल</h1>
      <h2>NAGAR PALIKA NAKUR</h2>
      <div class="gajab-tagline">
        <i class="fas fa-shield-alt"></i> OTP सत्यापन प्रणाली <i class="fas fa-mobile-alt"></i>
      </div>
    </div>
    
    <!-- लॉगिन कार्ड -->
    <div class="gajab-card">
      <!-- लोगो सेक्शन -->
      <div class="logo-section">
        <div class="gajab-logo-container">
          <img src="https://sunnydhaka.fwh.is/img1.png" alt="नगर पालिका नकुर लोगो" class="gajab-logo">
        </div>
        <div class="logo-text">
          <h3>गजब OTP लॉगिन</h3>
          <p>अपना मोबाइल नंबर दर्ज करें। हम आपको 6-अंकीय OTP भेजेंगे जिससे आप सुरक्षित रूप से लॉगिन कर सकें।</p>
        </div>
      </div>
      
      <!-- फॉर्म सेक्शन -->
      <div class="form-section">
        <div class="form-header">
          <h3>फोन सत्यापन</h3>
          <p>अपने मोबाइल नंबर पर OTP प्राप्त करें</p>
        </div>
        
        <!-- फोन नंबर पैनल -->
        <div id="phone-panel">
          <div class="form-group">
            <label for="phoneNumber"><i class="fas fa-mobile-alt"></i> मोबाइल नंबर</label>
            <div class="input-container">
              <i class="fas fa-phone"></i>
              <input type="tel" id="phoneNumber" class="form-input" placeholder="+91 8392969003" required>
              <div class="input-highlight"></div>
            </div>
            <small style="color: rgba(255,255,255,0.6); display: block; margin-top: 5px;">देश कोड (+91) के साथ नंबर डालें</small>
          </div>
          
          <div id="recaptcha-container"></div>
          
          <button id="sendOtpBtn" class="gajab-button">
            <span>OTP भेजें</span>
            <i class="fas fa-paper-plane"></i>
            <div class="button-glow"></div>
          </button>
        </div>
        
        <!-- OTP पैनल -->
        <div id="otp-panel" class="hidden">
          <div class="form-group">
            <label for="otpCode"><i class="fas fa-key"></i> OTP कोड</label>
            <div class="input-container">
              <i class="fas fa-sms"></i>
              <input type="text" id="otpCode" class="form-input" placeholder="123456" maxlength="6" required>
              <div class="input-highlight"></div>
            </div>
            <small style="color: rgba(255,255,255,0.6); display: block; margin-top: 5px;">आपके नंबर पर भेजा गया 6-अंकीय कोड</small>
          </div>
          
          <div class="timer hidden" id="timer">
            OTP फिर से भेजने के लिए <span id="countdown">60</span> सेकंड प्रतीक्षा करें
          </div>
          
          <div class="resend-link">
            <a href="#" id="resendOtpLink" onclick="resendOTP()">OTP फिर से भेजें</a>
          </div>
          
          <button id="verifyOtpBtn" class="gajab-button verify-btn">
            <span>लॉगिन करें</span>
            <i class="fas fa-check-circle"></i>
            <div class="button-glow"></div>
          </button>
          
          <button id="backBtn" class="gajab-button" style="background: rgba(255,255,255,0.1); color: white; margin-top: 10px;">
            <span>वापस जाएं</span>
            <i class="fas fa-arrow-left"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- नोटिफिकेशन -->
  <div class="gajab-notification" id="notification">
    <i class="fas fa-info-circle" id="notification-icon"></i>
    <div>
      <h4 id="notification-title">सूचना</h4>
      <p id="notification-message">संदेश यहाँ दिखाई देगा</p>
    </div>
  </div>

  <script>
    // Firebase कॉन्फ़िगरेशन
    const firebaseConfig = {
      apiKey: "AIzaSyCmW7XXpdHR0EjaTEE7mBeyE-8rHdP5rUc",
      authDomain: "nagar-palika-nakur.firebaseapp.com",
      projectId: "nagar-palika-nakur",
      storageBucket: "nagar-palika-nakur.appspot.com",
      messagingSenderId: "123456789012",
      appId: "1:123456789012:web:abcdef1234567890abcdef"
    };

    // Firebase इनिशियलाइज़ेशन
    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }
    
    const auth = firebase.auth();
    let confirmationResult = null;
    let recaptchaVerifier = null;
    let timerInterval = null;
    let timerSeconds = 60;

    // DOM Elements
    const phonePanel = document.getElementById('phone-panel');
    const otpPanel = document.getElementById('otp-panel');
    const phoneNumberInput = document.getElementById('phoneNumber');
    const otpCodeInput = document.getElementById('otpCode');
    const sendOtpBtn = document.getElementById('sendOtpBtn');
    const verifyOtpBtn = document.getElementById('verifyOtpBtn');
    const backBtn = document.getElementById('backBtn');
    const timerElement = document.getElementById('timer');
    const countdownElement = document.getElementById('countdown');
    const resendOtpLink = document.getElementById('resendOtpLink');
    const notification = document.getElementById('notification');
    const notificationIcon = document.getElementById('notification-icon');
    const notificationTitle = document.getElementById('notification-title');
    const notificationMessage = document.getElementById('notification-message');

    // पार्टिकल्स बनाएं
    function createParticles() {
      const particleCount = 30;
      for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');
        particle.style.left = `${Math.random() * 100}%`;
        particle.style.width = `${Math.random() * 6 + 2}px`;
        particle.style.height = particle.style.width;
        particle.style.background = `rgba(255, ${Math.random() * 100 + 155}, 0, ${Math.random() * 0.5 + 0.3})`;
        particle.style.animationDelay = `${Math.random() * 15}s`;
        particle.style.animationDuration = `${Math.random() * 10 + 10}s`;
        document.body.appendChild(particle);
      }
    }

    // नोटिफिकेशन दिखाएं
    function showNotification(title, message, type = 'info') {
      notificationTitle.textContent = title;
      notificationMessage.textContent = message;
      
      // आइकन सेट करें
      notificationIcon.className = 'fas fa-' + 
        (type === 'error' ? 'exclamation-circle' : 
         type === 'success' ? 'check-circle' : 'info-circle');
      
      // क्लास सेट करें
      notification.className = 'gajab-notification';
      notification.classList.add(type);
      notification.classList.add('show');
      
      // 5 सेकंड बाद हाइड करें
      setTimeout(() => {
        notification.classList.remove('show');
      }, 5000);
    }

    // टाइमर शुरू करें
    function startTimer() {
      timerSeconds = 60;
      countdownElement.textContent = timerSeconds;
      timerElement.classList.remove('hidden');
      resendOtpLink.style.pointerEvents = 'none';
      resendOtpLink.style.opacity = '0.5';
      
      timerInterval = setInterval(() => {
        timerSeconds--;
        countdownElement.textContent = timerSeconds;
        
        if (timerSeconds <= 0) {
          clearInterval(timerInterval);
          timerElement.classList.add('hidden');
          resendOtpLink.style.pointerEvents = 'auto';
          resendOtpLink.style.opacity = '1';
        }
      }, 1000);
    }

    // Recaptcha सेटअप
    function setupRecaptcha() {
      recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
        'size': 'normal',
        'callback': (response) => {
          // Recaptcha सॉल्व हो गया
          sendOtpBtn.disabled = false;
        },
        'expired-callback': () => {
          // Recaptcha एक्सपायर
          showNotification('समय समाप्त', 'कृपया recaptcha फिर से सॉल्व करें', 'error');
          sendOtpBtn.disabled = true;
        }
      });
      
      recaptchaVerifier.render().catch((error) => {
        console.error("Recaptcha render error:", error);
        showNotification('त्रुटि', 'Recaptcha लोड करने में समस्या', 'error');
      });
    }

    // OTP भेजें
    async function sendOTP() {
      const phoneNumber = phoneNumberInput.value.trim();
      
      if (!phoneNumber) {
        showNotification('त्रुटि', 'कृपया मोबाइल नंबर दर्ज करें', 'error');
        return;
      }
      
      if (!phoneNumber.startsWith('+')) {
        showNotification('त्रुटि', 'कृपया देश कोड (+91) के साथ नंबर डालें', 'error');
        return;
      }
      
      try {
        sendOtpBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> भेज रहा है...';
        sendOtpBtn.disabled = true;
        
        confirmationResult = await auth.signInWithPhoneNumber(phoneNumber, recaptchaVerifier);
        
        // पैनल स्विच करें
        phonePanel.classList.add('hidden');
        otpPanel.classList.remove('hidden');
        
        // टाइमर शुरू करें
        startTimer();
        
        showNotification('सफलता!', `OTP ${phoneNumber} पर भेज दिया गया है`, 'success');
        
        // OTP फील्ड में ऑटो फोकस
        setTimeout(() => {
          otpCodeInput.focus();
        }, 300);
        
      } catch (error) {
        console.error("OTP send error:", error);
        
        let errorMessage = "OTP भेजने में त्रुटि";
        if (error.code === 'auth/invalid-phone-number') {
          errorMessage = "अमान्य मोबाइल नंबर";
        } else if (error.code === 'auth/too-many-requests') {
          errorMessage = "बहुत अधिक अनुरोध, कृपया कुछ समय बाद कोशिश करें";
        } else if (error.code === 'auth/quota-exceeded') {
          errorMessage = "कोटा समाप्त, कल फिर कोशिश करें";
        }
        
        showNotification('त्रुटि', errorMessage, 'error');
        recaptchaVerifier.clear();
        setupRecaptcha();
      } finally {
        sendOtpBtn.innerHTML = '<span>OTP भेजें</span><i class="fas fa-paper-plane"></i>';
        sendOtpBtn.disabled = false;
      }
    }

    // OTP सत्यापित करें
    async function verifyOTP() {
      const otpCode = otpCodeInput.value.trim();
      
      if (!otpCode || otpCode.length !== 6) {
        showNotification('त्रुटि', 'कृपया 6-अंकीय OTP दर्ज करें', 'error');
        return;
      }
      
      try {
        verifyOtpBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> सत्यापित कर रहा है...';
        verifyOtpBtn.disabled = true;
        
        const result = await confirmationResult.confirm(otpCode);
        const user = result.user;
        
        showNotification('गजब सफलता!', `लॉगिन सफल! स्वागत है ${user.phoneNumber}`, 'success');
        
        // यहाँ आप रीडायरेक्ट कर सकते हैं
        setTimeout(() => {
          // डैशबोर्ड पर रीडायरेक्ट करें
          window.location.href = "admin-dashboard.html";
          // अस्थायी रूप से:
          alert("लॉगिन सफल! असली सिस्टम में यहाँ डैशबोर्ड दिखेगा।");
        }, 2000);
        
      } catch (error) {
        console.error("OTP verify error:", error);
        
        let errorMessage = "गलत OTP कोड";
        if (error.code === 'auth/invalid-verification-code') {
          errorMessage = "अमान्य OTP कोड";
        } else if (error.code === 'auth/code-expired') {
          errorMessage = "OTP कोड एक्सपायर हो गया, नया OTP मांगें";
        }
        
        showNotification('त्रुटि', errorMessage, 'error');
        otpCodeInput.value = '';
        otpCodeInput.focus();
      } finally {
        verifyOtpBtn.innerHTML = '<span>लॉगिन करें</span><i class="fas fa-check-circle"></i>';
        verifyOtpBtn.disabled = false;
      }
    }

    // OTP फिर से भेजें
    function resendOTP() {
      if (timerSeconds > 0) return;
      
      recaptchaVerifier.clear();
      setupRecaptcha();
      sendOTP();
    }

    // वापस बटन
    function goBack() {
      otpPanel.classList.add('hidden');
      phonePanel.classList.remove('hidden');
      otpCodeInput.value = '';
      
      if (timerInterval) {
        clearInterval(timerInterval);
      }
      
      timerElement.classList.add('hidden');
      resendOtpLink.style.pointerEvents = 'auto';
      resendOtpLink.style.opacity = '1';
      
      // Recaptcha रीसेट करें
      recaptchaVerifier.clear();
      setupRecaptcha();
    }

    // इवेंट लिस्टनर्स
    document.addEventListener('DOMContentLoaded', function() {
      // पार्टिकल्स बनाएं
      createParticles();
      
      // डेमो नंबर सेट करें
      phoneNumberInput.value = "+91 8392969003";
      
      // Recaptcha सेटअप
      setupRecaptcha();
      
      // बटन क्लिक इवेंट्स
      sendOtpBtn.addEventListener('click', sendOTP);
      verifyOtpBtn.addEventListener('click', verifyOTP);
      backBtn.addEventListener('click', goBack);
      
      // Enter key support
      phoneNumberInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') sendOTP();
      });
      
      otpCodeInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') verifyOTP();
      });
      
      // OTP input validation
      otpCodeInput.addEventListener('input', function() {
        this.value = this.value.replace(/[^0-9]/g, '');
        if (this.value.length > 6) {
          this.value = this.value.substring(0, 6);
        }
      });
      
      // Phone input validation
      phoneNumberInput.addEventListener('input', function() {
        this.value = this.value.replace(/[^0-9+]/g, '');
      });
      
      // वेलकम नोटिफिकेशन
      setTimeout(() => {
        showNotification('गजब स्वागत है!', 'मोबाइल OTP से सुरक्षित लॉगिन करें', 'info');
      }, 1000);
    });
    
    // Firebase ऑथ स्टेट चेंज लिस्टनर
    auth.onAuthStateChanged((user) => {
      if (user) {
        console.log("User logged in:", user.phoneNumber);
      } else {
        console.log("User logged out");
      }
    });
  </script>
</body>
</html>